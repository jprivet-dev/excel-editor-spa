<div class="mb-2 text-end" *appIsGranted="'ROLE_ADMIN'">
  <button type="button" class="btn btn-outline-primary btn-sm" (click)="open()">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="16"
      height="16"
      fill="currentColor"
      class="bi bi-plus-circle-fill"
      viewBox="0 0 16 16"
    >
      <path
        d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"
      />
    </svg>
    Ajouter un groupe
  </button>
</div>

<mat-error *ngIf="errorMessage$ | async as message">
  {{ message }}
</mat-error>

<div class="table-wrapper">
  <div class="table-loading-shade" *ngIf="isLoading$ | async">
    <mat-spinner></mat-spinner>
  </div>
  <ng-container *ngIf="data$ | async as data">
    <table mat-table [dataSource]="data" class="mat-elevation-z8">
      <ng-container matColumnDef="#">
        <th mat-header-cell *matHeaderCellDef>#</th>
        <td mat-cell *matCellDef="let i = index">{{ i + 1 }}</td>
      </ng-container>

      <ng-container matColumnDef="nomDuGroupe">
        <th mat-header-cell *matHeaderCellDef>Nom du groupe</th>
        <td mat-cell *matCellDef="let row">{{ row.nomDuGroupe }}</td>
      </ng-container>

      <ng-container matColumnDef="anneeDebut">
        <th mat-header-cell *matHeaderCellDef>Année début</th>
        <td mat-cell *matCellDef="let row">{{ row.anneeDebut }}</td>
      </ng-container>

      <ng-container matColumnDef="anneeSeparation">
        <th mat-header-cell *matHeaderCellDef>Année séparation</th>
        <td mat-cell *matCellDef="let row">{{ row.anneeSeparation }}</td>
      </ng-container>

      <ng-container matColumnDef="presentation">
        <th mat-header-cell *matHeaderCellDef>Présentation</th>
        <td mat-cell *matCellDef="let row">{{ row.presentation }}</td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let row">
          <div class="actions-container">
            <button
              mat-mini-fab
              color="primary"
              title="Modifier '{{ row.nomDuGroupe }}'"
              (click)="update(row)"
            >
              <mat-icon>edit</mat-icon>
            </button>
            <button
              mat-mini-fab
              title="Supprimer '{{ row.nomDuGroupe }}'"
              (click)="delete(row)"
            >
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns$ | async"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns$ | async"></tr>
    </table>
  </ng-container>
</div>

<div class="mb-2 text-end" *appIsGranted="'ROLE_ADMIN'">
  <button type="button" class="btn btn-outline-primary btn-sm" (click)="open()">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="16"
      height="16"
      fill="currentColor"
      class="bi bi-plus-circle-fill"
      viewBox="0 0 16 16"
    >
      <path
        d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"
      />
    </svg>
    Ajouter un groupe
  </button>
</div>
