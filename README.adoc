:toc: macro
:toc-title: Summary
:toclevels: 3
:numbered:

ifndef::env-github[:icons: font]
ifdef::env-github[]
:status:
:outfilesuffix: .adoc
:caution-caption: :fire:
:important-caption: :exclamation:
:note-caption: :paperclip:
:tip-caption: :bulb:
:warning-caption: :warning:
endif::[]

:back_to_top_target: top-target
:back_to_top_label: â¬† Back to top
:back_to_top: <<{back_to_top_target},{back_to_top_label}>>

:main_title: Excel Editor (SPA with Angular)
:git_project_base: excel-editor
:git_project_api: {git_project_base}-api
:git_project_spa: {git_project_base}-spa
:git_project_insomnia: {git_project_base}-insomnia
:git_username: jprivet-dev
:git_url_api: https://github.com/{git_username}/{git_project_api}
:git_url_spa: https://github.com/{git_username}/{git_project_spa}
:git_url_insomnia: https://github.com/{git_username}/{git_project_insomnia}
:git_ssh_api: git@github.com:{git_username}/{git_project_api}
:git_ssh_spa: git@github.com:{git_username}/{git_project_spa}
:git_clone_ssh_api: git@github.com:{git_username}/{git_project_api}.git
:git_clone_ssh_spa: git@github.com:{git_username}/{git_project_spa}.git

:git_project_current: {git_project_spa}
:git_url_current: {git_url_spa}
:git_ssh_current: {git_ssh_spa}

// Releases
:project_release: v0.0.0-beta.1

[#{back_to_top_target}]
= {main_title}

image:https://badgen.net/badge/release/{project_release}/blue[Project release,link=https://github.com/jprivet-dev/excel-editor-api/releases/tag/{project_release}]
image:https://app.codacy.com/project/badge/Grade/b95abb50479e4198becce900e64885da["Codacy code quality", link="https://www.codacy.com/gh/jprivet-dev/excel-editor-spa/dashboard?utm_source=github.com&utm_medium=referral&utm_content=jprivet-dev/excel-editor-spa&utm_campaign=Badge_Grade"]
image:https://app.codacy.com/project/badge/Coverage/b95abb50479e4198becce900e64885da["Codacy code quality", link="https://www.codacy.com/gh/jprivet-dev/excel-editor-spa/dashboard?utm_source=github.com&utm_medium=referral&utm_content=jprivet-dev/excel-editor-spa&utm_campaign=Badge_Coverage"]

toc::[]

== Presentation

Study of an API (Symfony) and a SPA (Angular), to load data in CSV/Excel format, with consultation and modification of this data online.

|===
| API (Symfony/Docker) | {git_url_api}
| SPA (Angular/Docker) | {git_url_spa}
| Insomnia - design, debug and test the API (https://insomnia.rest/) | {git_url_insomnia}
|===

{back_to_top}

== Installation

This project was generated with https://github.com/angular/angular-cli[Angular CLI] version 14.0.4.

. `$ git clone {git_ssh_current}`.
. `$ cd {git_project_current}`.
. `$ make build`: Build (the first time) or rebuild fresh images if necessary.
. `$ make start`: Create and start containers (alias: `$ make up`).
. Open http://localhost:4200
. `$ make stop`: Stop and remove containers, networks (alias: `$ make down`).

{back_to_top}

== Style Guide

=== Angular coding style guide

[NOTE]
====
* https://angular.io/guide/styleguide
====

{back_to_top}

=== Container & Presentational Components

[NOTE]
====
* https://blog.angular-university.io/angular-component-design-how-to-avoid-custom-event-bubbling-and-extraneous-properties-in-the-local-component-tree/
* https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0
====

This project is inspired by this pattern (which can quickly become an anti-pattern if applied dogmatically).

What are the main points?

* *Container (or Smart) components*:
** Components that are aware of the service layer (no @Input, no @Output).
** *Top-level components*: highest level of components, only for components attached to a route.
** Examples: UserPage, FollowersSidebar, StoryContainer, FollowedUserList.
* *Presentational components*:
*** Components that receive inputs and emit events, nothing else (no services, only @Input and @Ouput).
*** Examples: Sidebar, Story, UserInfo, List
* *A presentational component can contain a container component*: it allows for logic for interaction with the service layer to be put deeply into the component tree (if that is where it makes the most sense to have it), also to simplify the intermediate components and avoids code repetition.

[quote, ANGULAR UNIVERSITY]
____
In practice its actually much more practical to mix and match the multiple types of component design as we need, and use different types of components at different levels of the tree as necessary - mixing the different features as much as we need.
____

{back_to_top}

=== Observable Data Services

[NOTE]
====
* https://blog.angular-university.io/how-to-build-angular2-apps-using-rxjs-observable-data-services-pitfalls-to-avoid/
====

This project uses simple stores with Observable Data Services, instead of @ngrx/store.

{back_to_top}

=== JSON naming convention

[NOTE]
====
* https://stackoverflow.com/questions/5543490/json-naming-convention-snake-case-camelcase-or-pascalcase
* https://google.github.io/styleguide/jsoncstyleguide.xml?showone=Property_Name_Format#Property_Name_Format
====

That project (API & SPA) use the `camelCase` format for the property names of JSON responses:

```
{
  "thisPropertyIsAnIdentifier": "identifier value"
}
```

{back_to_top}

== PHPStorm configuration

IMPORTANT: The following configuration are provided for *PHPStorm 2022.3.1*

=== Eslint & Prettier

==== Configure a remote Node.js interpreter [[configure-a-remote-node-js-interpreter]]

. Go in *Settings > Languages & Frameworks > Node.js*.
. In *Node interpreter*, click on *...* and *Add Remote...*.
. In the *Configure Node.js Remote Interpreter* window, choose *excel-editor-spa-node:latest* and click on *OK*.
. In the *Settings* window, click on *OK*.

image::doc/img/phpstorm-settings-node-remote-interpreter.png[]

image::doc/img/phpstorm-settings-node.png[]

{back_to_top}

==== Configure ESLint

NOTE: More information on https://www.jetbrains.com/help/phpstorm/eslint.html

CAUTION: Before you start: <<configure-a-remote-node-js-interpreter>>.

Configure in *Settings > Languages & Frameworks > JavaScript > Code Quality Tools > ESLint* :

image::doc/img/phpstorm-settings-eslint.png[]

After the configuration, you can see the ESLint alerts in your code. For example:

image::doc/img/phpstorm-settings-eslint-error.png[]

{back_to_top}

==== Configure Prettier

NOTE: More information on https://www.jetbrains.com/help/phpstorm/prettier.html

CAUTION: Before you start: <<configure-a-remote-node-js-interpreter>>.

Configure in *Settings > Languages & Frameworks > JavaScript > Prettier* :

image::doc/img/phpstorm-settings-prettier.png[]

{back_to_top}

==== Reformat with Prettier

After the configuration, you can reformat your code :

* With the shortcut *Ctrl+Alt+Maj+P*.
* From the contextual menu (*Right click > Reformat with Prettier*).

image::doc/img/phpstorm-settings-prettier-contextual-menu.png[]

TIP: It's possible to reformat on save.

To reformat on save, Go in *Settings > Languages & Frameworks > JavaScript > Prettier*, and check *On save* option:

image::doc/img/phpstorm-settings-prettier-on-save.png[]

If you click on *All actions on save...*, you will see the list of all activated actions:

image::doc/img/phpstorm-settings-tools-actions-on-save.png[]

TIP: I also use the *Optimize import* option. This removes unused imports and organizes import statements in the current file. See https://www.jetbrains.com/help/phpstorm/creating-and-optimizing-imports.html#optimize-imports.

{back_to_top}

== Codacy configuration

=== Code coverage

[NOTE]
====
* https://github.com/codacy/codacy-coverage-reporter
* https://github.com/karma-runner/karma-coverage
====

TIP: Karma: generate code coverage using https://istanbul.js.org/[Istanbul].

Duplicate `CODACY_PROJECT_TOKEN.sh`:

```
$ cp scripts/CODACY_PROJECT_TOKEN.sh.dist scripts/CODACY_PROJECT_TOKEN.sh
```

And define the API token `CODACY_PROJECT_TOKEN` (see https://app.codacy.com/gh/jprivet-dev/excel-editor-spa/settings/coverage).

The file `scripts/CODACY_PROJECT_TOKEN.sh` is ignored by Git and imported by `scripts/reporter.sh`.

The file `scripts/reporter.sh` generates code coverage and uploads the coverage reports on Codacy.

{back_to_top}

== Resources & Inspiration

=== JWT & Authentication

* Angular Authentication With JWT: https://blog.angular-university.io/angular-jwt-authentication/
* Angular Authentication: Using Route Guards
: https://medium.com/@ryanchenkie_40935/angular-authentication-using-route-guards-bf7a4ca13ae3
* JWT debugger: https://jwt.io/

=== Architecture

* https://dev-academy.com/angular-architecture-best-practices/
* https://www.simform.com/blog/angular-best-practices/
* https://medium.com/dev-jam/5-tips-best-practices-to-organize-your-angular-project-e900db08702e
https://angular.io/guide/styleguide#lift
* https://stackoverflow.com/questions/70924931/angular-structure-best-practices-coremodule
* https://michelestieven.medium.com/organizing-angular-applications-f0510761d65a

{back_to_top}

== Comments, suggestions?

Feel free to make comments/suggestions to me in the {git_url_current}/issues[Git issues section].

{back_to_top}

== License

"{main_title}" is released under the {git_url_current}/blob/main/LICENSE[*MIT License*]

---

{back_to_top}
